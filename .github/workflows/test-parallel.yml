name: Run Pytest Parallel
on:
  pull_request:
    branches-ignore:
      - "release/**"
      - "doc/**"

env:
  DJANGO_SETTINGS_MODULE: ${{ secrets.DJANGO_SETTINGS_MODULE }}
  MYSQL_DATABASE: ${{ secrets.MYSQL_DATABASE }}
  MYSQL_USER: ${{ secrets.MYSQL_USER }}
  MYSQL_PASSWORD: ${{ secrets.MYSQL_PASSWORD }}

jobs:
  Test:
    if: ${{ github.event.pull_request.draft == false }}
    name: Run Test Code
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v3
      - uses: ./.github/workflows/set-up-project.yml
      - name: Run Test
        run: poetry run pytest
